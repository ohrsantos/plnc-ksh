{
  "connector.class": "io.confluent.connect.jdbc.JdbcSourceConnector",
  "incrementing.column.name": "idPagamento",
  "transforms.createKey.type": "org.apache.kafka.connect.transforms.ValueToKey",
  "connection.password": "9D8?m>?q/2>$lQm",
  "transforms": "createKey,extractInt",
  "value.converter.schema.registry.basic.auth.user.info": "Q4FE6BV5B6TUPEKI:f6BQNuTDyq6rzgzrvwWrDAZASpd0OiU8+OZ0wCiSfUdhROVkoGNcp3z3TCZsXxMP",
  "description": "Conector de entrada de dados transacionais referentes a pagamentos efetivados pela plataforma",
  "internal.key.converter.schemas.enable": "true",
  "value.converter.basic.auth.credentials.source": "USER_INFO",
  "mode": "incrementing",
  "topic.prefix": "topic-conn-pagamento-efetivacao",
  "transforms.createKey.fields": "cnpj",
  "poll.interval.ms": "1200000",
  "incrementing.offset": "0",
  "value.converter": "io.confluent.connect.avro.AvroConverter",
  "key.converter": "io.confluent.connect.avro.AvroConverter",
  "validate.non.null": "true",
  "max.poll.records": "5000",
  "query": "SELECT * FROM (SELECT cast(pgto.id_movimentopagamento AS bigint) AS idPagamento, cast(COALESCE(ov.Id_ExternoVenda , d.id_detalhemovimento) AS bigint) AS idTransacaoOriginal, (CASE m.id_tipomovimento WHEN 5 THEN 'AJUSTE' WHEN 6
 THEN 'AJUSTE' WHEN 30 THEN 'CHARGEBACK' WHEN 277 THEN 'CANCELAMENTO' WHEN 235 THEN 'VENDA' END) AS tipoEventoOriginal, pgto.dt_PrevistaRepasse AS dataEnvioPagamento, pgto.dt_PrevistaRepasse AS dataPagamento, m.dt_origemmovimento AS dataT
ransacao, cast(m.id_estabelecimento AS varchar) AS merchantId, c.no_cnpj AS cnpj, substring(c.no_cnpj, 1, 8) AS raizCnpj, ( CASE WHEN m.id_tipomovimento IN (5,6) THEN abs(d.vl_bruto) ELSE ov.vl_operacao END) AS valorTransacao, ABS(pgto.vl
_movimento) AS valorPagamento, db.no_agencia AS agenciaBancaria, db.no_contacorrente AS contaCorrente, db.no_DigitoContaCorrente AS digitoContaCorrente, db.no_banco AS codigoBanco, cast(ov.no_TransacaoTEF AS bigint) as nsuTef, cast(0 AS b
igint) as nsuTerminal, ov.Id_Adquirente as codigoAdquirente, ov.no_Autorizacao as codigoAutorizacao, c.Id_Estabelecimento as idEstabelecimento  FROM movimento_pagamento pgto (nolock)  INNER JOIN Movimento_Pagamento m (nolock) ON pgto.id_R
epasse = m.id_Repasse  INNER JOIN detalhe_movimento_pagamento d (nolock) ON m.id_movimentopagamento = d.id_movimentopagamento  LEFT JOIN operacao_venda ov (nolock) ON d.id_operacaovenda = ov.id_operacaovenda  inner JOIN credor c (nolock) 
ON c.id_Credor = m.id_Credor inner JOIN dados_bancarios db (nolock) ON c.id_dadosbancarios = db.id_dadosbancarios WHERE m.id_tipomovimento IN (5, 6, 30, 277, 235) AND pgto.id_tipomovimento in (220) AND pgto.dt_GeracaoMovimento > DATEADD(d
ay, -60, SYSDATETIME())) AS PagamentoEfetivacao",
  "producer.buffer.memory": "26843545",
  "transforms.extractInt.type": "org.apache.kafka.connect.transforms.ExtractField$Key",
  "offset.flush.timeout.ms": "6000",
  "version": "1",
  "offset.flush.interval.ms": "30000",
  "value.converter.schema.registry.url": "https://psrc-em82q.us-east-2.aws.confluent.cloud",
  "transforms.extractInt.field": "cnpj",
  "connection.user": "confluent_ben_login",
  "internal.value.converter.schemas.enable": "true",
  "name": "conn-in-pagamento-efetivacao",
  "key.converter.schema.registry.basic.auth.user.info": "Q4FE6BV5B6TUPEKI:f6BQNuTDyq6rzgzrvwWrDAZASpd0OiU8+OZ0wCiSfUdhROVkoGNcp3z3TCZsXxMP",
  "connection.url": "jdbc:sqlserver://10.50.131.85:1433;databaseName=Adquirente;selectMethod=cursor",
  "key.converter.schema.registry.url": "https://psrc-em82q.us-east-2.aws.confluent.cloud",
  "quote.sql.identifiers": "NEVER",
  "key.converter.basic.auth.credentials.source": "USER_INFO"
}
